{% extends "dashboard.html" %}
{% block content %}

<div class="container py-4">

  <!-- TOP BAR -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-semibold mb-0">Subscriptions</h3>
    <div class="buttons gap-2">
      <a href="/dashboard/addpaper" class="btn btn-outline-primary">
        + Edit/Add Paper
      </a>
      <a href="/dashboard/addbooklet" class="btn btn-outline-warning">
        + Edit/Booklets Paper
      </a>
    </div>
  </div>

  <!-- SUBSCRIPTIONS -->
  <div class="row gy-4">

    <!-- NEWSPAPERS -->
    <div class="col-lg-6">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="mb-3">ðŸ“° Newspapers</h5>

          {% if newspapers %}
            {% for p in newspapers %}
              <div class="item-row {% if p.is_active %}active{% else %}inactive{% endif %}">
                <div>
                  <div class="fw-medium">{{ p.newspaper.name }}</div>
                  <small class="status">
                    {% if p.is_active %}Subscribed{% else %}Pending{% endif %}
                  </small>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="text-muted small">No newspapers added</p>
          {% endif %}

        </div>
      </div>
    </div>

    <!-- BOOKLETS -->
    <div class="col-lg-6">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="mb-3">ðŸ“˜ Booklets</h5>

          {% if booklets %}
            {% for b in booklets %}
              <div class="item-row {% if b.is_active %}active{% else %}inactive{% endif %}">
                <div>
                  <div class="fw-medium">{{ b.booklet.title }}</div>
                  <small class="status">
                    {% if b.is_active %}Subscribed{% else %}Pending{% endif %}
                  </small>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="text-muted small">No booklets added</p>
          {% endif %}

        </div>
      </div>
    </div>

  </div>

  <!-- BILL SECTION -->
  {% if pending_newspapers or pending_booklets %}
  <div class="card border-0 shadow-sm mt-5">
    <div class="card-body">

      <!-- BILL HEADER -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">ðŸ’³ Pending Payments (This Month)</h5>
        <button class="btn btn-success btn-sm">
          Pay All
        </button>
      </div>

      <!-- BILL LIST -->
      <div class="bill-box">

        {% for p in pending_newspapers %}
          <div class="bill-row">
            <span>{{ p.newspaper.name }}</span>
            <span class="price">â‚¹{{ p.newspaper.price }} X 30</span>
          </div>
        {% endfor %}

        {% for b in pending_booklets %}
          <div class="bill-row">
            <span>{{ b.booklet.title }}</span>
            <span class="price">â‚¹{{ b.booklet.price }} X 4</span>
          </div>
        {% endfor %}

      </div>

      <!-- TOTAL -->
      <div class="bill-total">
        <span>Total Amount</span>
        <span class="fw-semibold">â‚¹{{ total_amount }}/Month</span>
      </div>

    </div>
  </div>
  {% endif %}

</div>

<style>
.item-row{
  border: 1px solid #e6e6e6;
  border-radius: 10px;
  padding: 12px 14px;
  margin-bottom: 10px;
}
.item-row.active{
  border-left: 4px solid #198754;
  background: #f6fffa;
}
.item-row.inactive{
  border-left: 4px solid #fd7e14;
  background: #fff9f2;
}
.status{
  font-size: 12px;
  color: #6c757d;
}

.bill-box{
  border: 1px solid #eee;
  border-radius: 10px;
  padding: 12px 14px;
  margin-bottom: 10px;
}

.bill-row{
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px dashed #ddd;
}
.bill-row:last-child{
  border-bottom: none;
}

.price{
  color: #198754;
  font-weight: 500;
}

.bill-total{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 12px;
  margin-top: 12px;
  border-top: 2px solid #eee;
  font-size: 15px;
}
</style>

{% endblock %}
